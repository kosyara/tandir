<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–°–ª–æ–º–∞–π –¢–∞–Ω–¥—ã—Ä –ö–æ–≤—à–æ–º</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f8e7c9;
        text-align: center;
        margin: 0;
        padding: 20px;
    }

    #gameArea {
        position: relative;
        width: 100%;
        max-width: 320px;
        height: 360px;
        margin: 0 auto;
    }

    #tandir {
        width: 100%;
        height: 300px;
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        transition: transform 0.1s;
    }

    #kovsh {
        width: 45%;
        position: absolute;
        right: -10%;
        top: 45%;
        transform-origin: left center;
        transform: rotate(0deg);
        transition: transform 0.1s;
        pointer-events: none;
    }

    #tandir.shake {
        transform: translateX(-10px);
    }

    #hpBar {
        width: 100%;
        max-width: 320px;
        height: 25px;
        background: #ddd;
        border-radius: 12px;
        margin: 20px auto;
        overflow: hidden;
    }

    #hpFill {
        height: 100%;
        width: 100%;
        background: #d9534f;
        transition: width 0.25s;
    }

    #hitBtn {
        font-size: 22px;
        padding: 15px 30px;
        background: #c87a2b;
        border: none;
        border-radius: 10px;
        color: white;
        cursor: pointer;
        width: 100%;
        max-width: 280px;
    }

    #hitBtn:active {
        background: #a86623;
    }

    #log {
        font-size: 20px;
        margin-top: 15px;
        min-height: 40px;
    }

</style>

</head>
<body>

<h1>ü•£ –°–ª–æ–º–∞–π –¢–∞–Ω–¥—ã—Ä –ö–æ–≤—à–æ–º!</h1>

<div id="gameArea">
    <div id="tandir"></div>
    <img id="kovsh" src="kovsh.png">
</div>

<div id="hpBar">
    <div id="hpFill"></div>
</div>

<button id="hitBtn">–£–î–ê–†–ò–¢–¨ –ö–û–í–®–û–ú</button>

<div id="log"></div>

<script>
// -------------------------
// PRELOAD –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
// -------------------------
const preloadImages = [
    "damage1.png",
    "damage2.png",
    "damage3.png",
    "damage4.png",
    "kovsh.png"
];

preloadImages.forEach(src => {
    const img = new Image();
    img.src = src;
});

// -------------------------
let hp = 100;

const tandirStages = [
    "damage1.png",
    "damage2.png",
    "damage3.png",
    "damage4.png"
];

const tandir = document.getElementById("tandir");
const hpFill = document.getElementById("hpFill");
const logBox = document.getElementById("log");
const btn = document.getElementById("hitBtn");
const kovsh = document.getElementById("kovsh");

// —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É
tandir.style.backgroundImage = `url(${tandirStages[0]})`;

btn.onclick = hitFunction;
btn.addEventListener("touchstart", hitFunction, {passive: true});

// -------------------------
// –§–£–ù–ö–¶–ò–Ø –£–î–ê–†–ê
// -------------------------
function hitFunction() {
    if (hp <= 0) return;

    let dmg = Math.floor(Math.random() * 15) + 10;
    hp -= dmg;
    if (hp < 0) hp = 0;

    hpFill.style.width = hp + "%";
    logBox.innerText = `–¢—ã —É–¥–∞—Ä–∏–ª –∫–æ–≤—à–æ–º –∏ –Ω–∞–Ω—ë—Å ${dmg} —É—Ä–æ–Ω–∞!`;

    tandir.classList.add("shake");
    setTimeout(() => tandir.classList.remove("shake"), 120);

    kovsh.style.transform = "rotate(-50deg)";
    setTimeout(() => { kovsh.style.transform = "rotate(0deg)"; }, 130);

    if (hp > 75) tandir.style.backgroundImage = `url(${tandirStages[0]})`;
    else if (hp > 50) tandir.style.backgroundImage = `url(${tandirStages[1]})`;
    else if (hp > 25) tandir.style.backgroundImage = `url(${tandirStages[2]})`;
    else tandir.style.backgroundImage = `url(${tandirStages[3]})`;

    if (hp <= 0) endGame();
}

// -------------------------
// –ö–û–ù–ï–¶ –ò–ì–†–´
// -------------------------
function endGame() {
    logBox.innerHTML = "üî• –¢–∞–Ω–¥—ã—Ä —Ä–∞–∑—Ä—É—à–µ–Ω!";
    btn.innerText = "–ó–∞–Ω–æ–≤–æ";
    btn.onclick = restartGame;

    tandir.style.transform = "scale(0.85) rotate(10deg)";
}

// -------------------------
// –†–ï–°–¢–ê–†–¢
// -------------------------
function restartGame() {
    hp = 100;
    hpFill.style.width = "100%";
    logBox.innerText = "";
    tandir.style.transform = "scale(1) rotate(0deg)";
    tandir.style.backgroundImage = `url(${tandirStages[0]})`;

    btn.innerText = "–£–î–ê–†–ò–¢–¨ –ö–û–í–®–û–ú";
    btn.onclick = hitFunction;
}

</script>

</body>
</html>
